<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    {% load staticfiles %}
    {% load widget_tweaks %}
    <link rel="stylesheet" type="text/css" href="{% static 'helpdesk/style.css' %}" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
    <script type='text/javascript' language='javascript'>
        $(function() {

    $('#login-form-link').click(function(e) {
        $("#error-login").empty();
		$("#login-form").delay(100).fadeIn(100);
 		$("#register-form").fadeOut(100);
		$('#register-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});
	$('#register-form-link').click(function(e) {
	    $("#error-login").empty();
		$("#register-form").delay(100).fadeIn(100);
 		$("#login-form").fadeOut(100);
		$('#login-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});

	$('#login-form').submit(function(e){
        e.preventDefault();
        var data = $(this).serialize();
        data+='&login';
        $.ajax({
            type: "POST",
            url: "",
            data: data,
            cache: false,
            success: function(data){
                if (data=="approved_user") {
                    window.location.href = "index";
                }
                 if (data=="approved_staff") {
                    window.location.href = "tickets";
                }
                $('#error-login').html(data);
            }
       });
    });
	$('#register-form').submit(function(e){
	    if ($('#reg_password').val() != $('#confirm_reg_password').val()) {
            $('#error-login').html('Пароли не совпадают.');
            return false;
        }
        e.preventDefault();
        var data = $(this).serialize();
        data+='&register';
        $.ajax({
            type: "POST",
            url: "",
            data: data,
            cache: false,
            success: function(data){
                $('#error-login').html(data);
            }
       });
    });

	//doesn't work
	$("#username_id").change(function () {
      var form = $(this).find("#register-form");
      $.ajax({
        url: "validate_username/",
        data: form.serialize(),
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            alert(data.error_message);
          }
        }
      });
    });
});
        $('#loginForm').attr('autocomplete', 'off');
        $('#remember').change(function() {
    if (this.checked) {
        $('#loginForm').attr('autocomplete', 'on');
    } else {
        $('#loginForm').attr('autocomplete', 'off');
    }
});
    </script>

</head>
<body>
{#<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>#}
{#{% if latest_question_list %}#}
{#    <ul>#}
{#    {% for question in latest_question_list %}#}
{#        <li><a href="{% url 'detail' question.id %}">{{ question.question_text }}</a></li>#}
{#    {% endfor %}#}
{#    </ul>#}
{#{% else %}#}
{#    <p>No helpdesk are available.</p>#}
{#{% endif %}#}
{#	<nav class="navbar navbar-inverse navbar-fixed-top">#}
{#		<div class="container">#}
{#			<div class="navbar-header">#}
{#				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>#}
{#				<a class="navbar-brand logo" href="#"></a>#}
{#			</div>#}
{#			<div id="navbar" class="collapse navbar-collapse">#}
{#				<ul class="nav navbar-nav">#}
{#					<li class="custome-active"><a href="#home">Home</a></li>#}
{#					<li><a href="#about">About</a></li>#}
{#					<li><a href="#features">Features</a></li>#}
{#					<li><a href="#contact">Contact</a></li>#}
{#				</ul>#}
{#			</div>#}
{#			<!--/.nav-collapse -->#}
{#		</div>#}
{#	</nav>#}
<div class="container">
    	<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<div class="panel panel-login">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<a href="#" class="active" id="login-form-link">Вход</a>
							</div>
							<div class="col-xs-6">
								<a href="#" id="register-form-link">Регистрация</a>
							</div>
						</div>
						<hr>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-lg-12">
								<form id="login-form"  method="POST" role="form" style="display: block;">{% csrf_token %}
									<div class="form-group">
{#										<input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="">#}
                                        {{ form.username|attr:"class:form-control"|attr:"placeholder:Имя пользователя" }}
									</div>
									<div class="form-group">
{#										<input type="password" name="password" id="password" tabindex="2" class="form-control" placeholder="Password">#}
                                        {{ form.password|attr:"class:form-control"|attr:"placeholder:Пароль" }}
									</div>
									<div class="form-group text-center">
										<input type="checkbox" tabindex="3" class="" name="remember" id="remember">
										<label for="remember"> Запомнить</label>
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-login" value="Войти">
											</div>
										</div>
									</div>
{#									<div class="form-group">#}
{#										<div class="row">#}
{#											<div class="col-lg-12">#}
{#												<div class="text-center">#}
{#													<a href="" tabindex="5" class="forgot-password">Забыли пароль?</a>#}
{#												</div>#}
{#											</div>#}
{#										</div>#}
{#									</div>#}
								</form>
								<form id="register-form"  method="POST" role="form" style="display: none;">{% csrf_token %}
									<div class="form-group">
{#										<input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="">#}
                                        {{ form.username_reg|attr:"class:form-control"|attr:"placeholder:Имя пользователя"|attr:"id:username_id" }}
									</div>
{#									<div class="form-group">#}
{#										<input type="email" name="email" id="email" tabindex="1" class="form-control" placeholder="Email Address" value="">#}
{#									</div>#}
									<div class="form-group">
{#										<input type="password" name="password" id="password" tabindex="2" class="form-control" placeholder="Password">#}
                                        {{ form.password_reg|attr:"class:form-control"|attr:"placeholder:Пароль"|attr:"id:reg_password" |attr:"autocomplete=off"|attr:"id=username_id"}}
									</div>
									<div class="form-group">
{#										<input type="password" name="confirm-password" id="confirm-password" tabindex="2" class="form-control" placeholder="Confirm Password">#}
                                        {{ form.password_again|attr:"class:form-control"|attr:"placeholder:Повторите пароль"|attr:"id:confirm_reg_password"|attr:"autocomplete=off" }}
									</div>
                                    <div class="form-group">
{#										<input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="">#}
                                        {{ form.role|attr:"class:form-control"|attr:"placeholder:Должность"|attr:"id:role_idte" }}
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit" name="register-submit" id="register-submit" tabindex="4" class="form-control btn btn-register" value="Зарегистрироваться">
											</div>
										</div>
									</div>
								</form>
                                                                            <p id="error-login" class="test"></p>
                                            {% csrf_token %}
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>